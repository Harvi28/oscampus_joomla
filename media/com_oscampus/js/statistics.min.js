;(function($){$.Oscampus=$.extend({},$.Oscampus);$.Oscampus.statistics={options:{controls:'div.osc-course-tabs div.osc-tab',tab:'div.osc-tab',disabled:'osc-tab-disabled',target:'#osc-data-area',form:'#oscAdminForm',pagination:'.osc-pagination a',loading:null},init:function(options){options=$.extend(this.options,options);var $controls=$(this.options.controls),self=this;$controls.find('a').on('click',function(evt){evt.preventDefault();var $active=$(this).parent(options.tab);if($active.hasClass(options.disabled)){$controls.each(function(idx,el){if($active[0]===el){$(el).removeClass(options.disabled).find('a').css('cursor','default');}else{$(el).addClass(options.disabled).find('a').css('cursor','pointer');}});self.load($(this).attr('href').substr(1));}});$controls.not('.'+options.disabled).addClass(options.disabled).find('a').trigger('click');},load:function($report,$start){$('html,body').animate({scrollTop:0},'slow');var loading=this.options.loading||Joomla.JText._('COM_OSCAMPUS_LOADING'),$target=$(this.options.target),$form=$(this.options.form),$url=$form.attr('action'),$reportField=$form.find('input[name=report]'),$returnField=$form.find('input[name=return]');if($start){$url+='?start='+$start;}
$returnField.val($reportField.val());$reportField.val($report);var $data=$form.serialize();$target.html(loading).load($url,$data,function(response,status,xhr){if(status==='error'){if(xhr.responseText){$target.html(xhr.responseText);}else{var msg=Joomla.JText._('COM_OSCAMPUS_ERROR_GENERIC_PREFIX');$target.html(msg.replace('%s',xhr.status+' '+xhr.statusText));}}});},back:function(){var returnReport=$(this.options.form).find('input[name=return]').val();if(returnReport){this.load(returnReport);}},setPagination:function(task){if(task){var self=this;$(this.options.form).find('[name=limit]').attr('onchange',null).on('change',function(evt){self.load(task);});$(this.options.pagination).on('click',function(evt){evt.preventDefault();evt.stopPropagation();var $start=$(this).attr('href').match(/start=(\d*)/);self.load(task,$start?$start[1]:1);});}}};})(jQuery);